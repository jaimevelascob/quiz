{"remainingRequest":"/home/hab35/Hackabos/proyectoHack/front/node_modules/babel-loader/lib/index.js!/home/hab35/Hackabos/proyectoHack/front/src/api/utils.js","dependencies":[{"path":"/home/hab35/Hackabos/proyectoHack/front/src/api/utils.js","mtime":1592589485851},{"path":"/home/hab35/Hackabos/proyectoHack/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab35/Hackabos/proyectoHack/front/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2hhYjM1L0hhY2thYm9zL3Byb3llY3RvSGFjay9mcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBqd3QgZnJvbSAiand0LWRlY29kZSI7CnZhciBFTkRQT0lOVCA9ICJodHRwOi8vbG9jYWxob3N0OjMwMDAiOwp2YXIgQVVUSF9UT0tFTl9LRVkgPSAiYXV0aFRva2VuIjsKdmFyIFJPTEUgPSAicm9sZSI7IC8vRlVOQ0lPTiBMT0dJTgoKZXhwb3J0IGZ1bmN0aW9uIGxvZ2luVXNlcihlbWFpbCwgcGFzc3dvcmQpIHsKICByZXR1cm4gbmV3IFByb21pc2UoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBheGlvcyh7CiAgICAgICAgICAgICAgICB1cmw6ICIiLmNvbmNhdChFTkRQT0lOVCwgIi91c2Vycy9sb2dpbiIpLAogICAgICAgICAgICAgICAgLy9VUkwgREUgTEEgQVVURU5USUNBQ0nDk04KICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgLy9Nw4lUT0RPIERFIExBIEFVVEVOVElGSUNBQ0nDk04KICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgdXN1YXJpbzogZW1haWwsCiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCwKICAgICAgICAgICAgICAgICAgZ3JhbmRfdHlwZTogInBhc3N3b3JkIgogICAgICAgICAgICAgICAgfSAvLyBEQVRPUyBERSBMQSBBVVRFTlRJRklDQUNJw5NOCgogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgc2V0QXV0aFRva2VuKHJlcy5kYXRhLmRhdGEudG9rZW4pOwogICAgICAgICAgICAgIHNldElzQWRtaW4ocmVzLmRhdGEuaXNBZG1pbik7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBpZiAoX2NvbnRleHQudDAucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KF9jb250ZXh0LnQwLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgZW4gbG9naW46ICIsIF9jb250ZXh0LnQwKTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgOV1dKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpKTsKfSAvL0dVQVJEQVIgVE9LRU4gRU4gTE9DQUxTVE9SQUdFCgpleHBvcnQgZnVuY3Rpb24gc2V0QXV0aFRva2VuKHRva2VuKSB7CiAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9ICJCZWFyZXIgIi5jb25jYXQodG9rZW4pOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKEFVVEhfVE9LRU5fS0VZLCB0b2tlbik7Cn0gLy9MT0dPVVQKCmV4cG9ydCBmdW5jdGlvbiBjbGVhckxvZ2luKCkgewogIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl0gPSAiIjsKICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShBVVRIX1RPS0VOX0tFWSk7CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oIlVzdWFyaW8iKTsKICBjbGVhckFkbWluKCk7Cn0gLy9DT0dFUiBFTCBUT0tFTgoKZXhwb3J0IGZ1bmN0aW9uIGdldEF1dGhUb2tlbigpIHsKICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oQVVUSF9UT0tFTl9LRVkpOwp9IC8vQ09OU0lHVUlFTkRPIEZFQ0hBIERFIENBRFVDSURBRCBERUwgVE9LRU4KCmV4cG9ydCBmdW5jdGlvbiBnZXRUb2tlbkV4cGlyYXRpb25EYXRlKGVuY29kZWRUb2tlbikgewogIHZhciB0b2tlbiA9IGp3dChlbmNvZGVkVG9rZW4pOyAvL3NpIG5vIGhheSwgbm8gc2lndWUKCiAgaWYgKCF0b2tlbi5leHApIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgwKTsKICBkYXRlLnNldFVUQ1NlY29uZHModG9rZW4uZXhwKTsKICByZXR1cm4gZGF0ZTsKfSAvL0NPTVBST0JBTkRPIFNJIExBIEZFQ0hBIFNJR1VFIFZJR0VOVEUgTyBOTwoKZXhwb3J0IGZ1bmN0aW9uIGlzVG9rZW5FeHBpcmVkKHRva2VuKSB7CiAgdmFyIGV4cGlyYXRpb25EYXRlID0gZ2V0VG9rZW5FeHBpcmF0aW9uRGF0ZSh0b2tlbik7CiAgcmV0dXJuIGV4cGlyYXRpb25EYXRlIDwgbmV3IERhdGUoKTsKfSAvL0NPTVBST0JBUiBTSSBFTCBVU0VSIEVTVMOBIExPR0VBRE8gTyBOTwoKZXhwb3J0IGZ1bmN0aW9uIGlzTG9nZ2VkSW4oKSB7CiAgdmFyIGF1dGhUb2tlbiA9IGdldEF1dGhUb2tlbigpOwogIHJldHVybiAhIWF1dGhUb2tlbiAmJiAhaXNUb2tlbkV4cGlyZWQoYXV0aFRva2VuKTsKfSAvLyAgLS0tLUZVTkNJT05FUyBQQVJBIENPTVBST0JBUiBFTCBST0wgREVMIFVTRVItLS0tLQovL0dVQVJEQVIgU0kgRVMgQURNSU4gRU4gTE9DQUwgU1RPUkFHRQoKZXhwb3J0IGZ1bmN0aW9uIHNldElzQWRtaW4oaXNBZG1pbikgewogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFJPTEUsIGlzQWRtaW4pOwp9IC8vQk9SUkFSIFJPTCBERUwgVVNFUiBFTiBMT0NBTCBTVE9SQUdFCgpleHBvcnQgZnVuY3Rpb24gY2xlYXJBZG1pbigpIHsKICByZXR1cm4gbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oUk9MRSk7Cn0gLy8gUkVDVVBFUkFSIFJPTCBERVNERSBMT0NBTCBTVE9SQUdFCgpleHBvcnQgZnVuY3Rpb24gZ2V0SXNBZG1pbigpIHsKICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oUk9MRSk7Cn0gLy9DT01QUk9CQVIgUk9MCgpleHBvcnQgZnVuY3Rpb24gY2hlY2tBZG1pbigpIHsKICB2YXIgcm9sZSA9IGZhbHNlOwogIHZhciBpc0FkbWluID0gZ2V0SXNBZG1pbigpOwoKICBpZiAoaXNBZG1pbiA9PT0gInRydWUiKSB7CiAgICByb2xlID0gdHJ1ZTsKICB9IGVsc2UgewogICAgcm9sZSA9IGZhbHNlOwogIH0KCiAgcmV0dXJuIHJvbGU7Cn0="},{"version":3,"sources":["/home/hab35/Hackabos/proyectoHack/front/src/api/utils.js"],"names":["axios","jwt","ENDPOINT","AUTH_TOKEN_KEY","ROLE","loginUser","email","password","Promise","resolve","reject","url","method","data","usuario","grand_type","res","setAuthToken","token","setIsAdmin","isAdmin","response","status","alert","message","console","log","defaults","headers","common","localStorage","setItem","clearLogin","removeItem","clearAdmin","getAuthToken","getItem","getTokenExpirationDate","encodedToken","exp","date","Date","setUTCSeconds","isTokenExpired","expirationDate","isLoggedIn","authToken","getIsAdmin","checkAdmin","role"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,YAAhB;AAEA,IAAMC,QAAQ,GAAG,uBAAjB;AACA,IAAMC,cAAc,GAAG,WAAvB;AACA,IAAMC,IAAI,GAAG,MAAb,C,CAEA;;AACA,OAAO,SAASC,SAAT,CAAmBC,KAAnB,EAA0BC,QAA1B,EAAoC;AACzC,SAAO,IAAIC,OAAJ;AAAA,uEAAY,iBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAECV,KAAK,CAAC;AACpBW,gBAAAA,GAAG,YAAKT,QAAL,iBADiB;AACY;AAChCU,gBAAAA,MAAM,EAAE,MAFY;AAEJ;AAChBC,gBAAAA,IAAI,EAAE;AACJC,kBAAAA,OAAO,EAAER,KADL;AAEJC,kBAAAA,QAAQ,EAAEA,QAFN;AAGJQ,kBAAAA,UAAU,EAAE;AAHR,iBAHc,CAOjB;;AAPiB,eAAD,CAFN;;AAAA;AAEXC,cAAAA,GAFW;AAWfC,cAAAA,YAAY,CAACD,GAAG,CAACH,IAAJ,CAASA,IAAT,CAAcK,KAAf,CAAZ;AACAC,cAAAA,UAAU,CAACH,GAAG,CAACH,IAAJ,CAASO,OAAV,CAAV;AACAX,cAAAA,OAAO;AAbQ;AAAA;;AAAA;AAAA;AAAA;;AAef,kBAAI,YAAIY,QAAJ,CAAaC,MAAb,KAAwB,GAA5B,EAAiC;AAC/BC,gBAAAA,KAAK,CAAC,YAAIF,QAAJ,CAAaR,IAAb,CAAkBW,OAAnB,CAAL;AACD;;AACDC,cAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;;AAlBe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAqBD,C,CAED;;AACA,OAAO,SAAST,YAAT,CAAsBC,KAAtB,EAA6B;AAClClB,EAAAA,KAAK,CAAC2B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,qBAA2DX,KAA3D;AACAY,EAAAA,YAAY,CAACC,OAAb,CAAqB5B,cAArB,EAAqCe,KAArC;AACD,C,CAED;;AACA,OAAO,SAASc,UAAT,GAAsB;AAC3BhC,EAAAA,KAAK,CAAC2B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiD,EAAjD;AACAC,EAAAA,YAAY,CAACG,UAAb,CAAwB9B,cAAxB;AACA2B,EAAAA,YAAY,CAACG,UAAb,CAAwB,SAAxB;AACAC,EAAAA,UAAU;AACX,C,CAED;;AACA,OAAO,SAASC,YAAT,GAAwB;AAC7B,SAAOL,YAAY,CAACM,OAAb,CAAqBjC,cAArB,CAAP;AACD,C,CAED;;AACA,OAAO,SAASkC,sBAAT,CAAgCC,YAAhC,EAA8C;AACnD,MAAIpB,KAAK,GAAGjB,GAAG,CAACqC,YAAD,CAAf,CADmD,CAEnD;;AACA,MAAI,CAACpB,KAAK,CAACqB,GAAX,EAAgB;AACd,WAAO,IAAP;AACD;;AACD,MAAIC,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAAT,CAAX;AACAD,EAAAA,IAAI,CAACE,aAAL,CAAmBxB,KAAK,CAACqB,GAAzB;AACA,SAAOC,IAAP;AACD,C,CAED;;AACA,OAAO,SAASG,cAAT,CAAwBzB,KAAxB,EAA+B;AACpC,MAAI0B,cAAc,GAAGP,sBAAsB,CAACnB,KAAD,CAA3C;AACA,SAAO0B,cAAc,GAAG,IAAIH,IAAJ,EAAxB;AACD,C,CAED;;AACA,OAAO,SAASI,UAAT,GAAsB;AAC3B,MAAIC,SAAS,GAAGX,YAAY,EAA5B;AACA,SAAO,CAAC,CAACW,SAAF,IAAe,CAACH,cAAc,CAACG,SAAD,CAArC;AACD,C,CAED;AAEA;;AACA,OAAO,SAAS3B,UAAT,CAAoBC,OAApB,EAA6B;AAClCU,EAAAA,YAAY,CAACC,OAAb,CAAqB3B,IAArB,EAA2BgB,OAA3B;AACD,C,CAED;;AACA,OAAO,SAASc,UAAT,GAAsB;AAC3B,SAAOJ,YAAY,CAACG,UAAb,CAAwB7B,IAAxB,CAAP;AACD,C,CAED;;AACA,OAAO,SAAS2C,UAAT,GAAsB;AAC3B,SAAOjB,YAAY,CAACM,OAAb,CAAqBhC,IAArB,CAAP;AACD,C,CAED;;AACA,OAAO,SAAS4C,UAAT,GAAsB;AAC3B,MAAIC,IAAI,GAAG,KAAX;AACA,MAAI7B,OAAO,GAAG2B,UAAU,EAAxB;;AACA,MAAI3B,OAAO,KAAK,MAAhB,EAAwB;AACtB6B,IAAAA,IAAI,GAAG,IAAP;AACD,GAFD,MAEO;AACLA,IAAAA,IAAI,GAAG,KAAP;AACD;;AACD,SAAOA,IAAP;AACD","sourcesContent":["import axios from \"axios\";\nimport jwt from \"jwt-decode\";\n\nconst ENDPOINT = \"http://localhost:3000\";\nconst AUTH_TOKEN_KEY = \"authToken\";\nconst ROLE = \"role\";\n\n//FUNCION LOGIN\nexport function loginUser(email, password) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      let res = await axios({\n        url: `${ENDPOINT}/users/login`, //URL DE LA AUTENTICACIÓN\n        method: \"POST\", //MÉTODO DE LA AUTENTIFICACIÓN\n        data: {\n          usuario: email,\n          password: password,\n          grand_type: \"password\",\n        }, // DATOS DE LA AUTENTIFICACIÓN\n      });\n      setAuthToken(res.data.data.token);\n      setIsAdmin(res.data.isAdmin);\n      resolve();\n    } catch (err) {\n      if (err.response.status === 404) {\n        alert(err.response.data.message);\n      }\n      console.log(\"Error en login: \", err);\n    }\n  });\n}\n\n//GUARDAR TOKEN EN LOCALSTORAGE\nexport function setAuthToken(token) {\n  axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n  localStorage.setItem(AUTH_TOKEN_KEY, token);\n}\n\n//LOGOUT\nexport function clearLogin() {\n  axios.defaults.headers.common[\"Authorization\"] = \"\";\n  localStorage.removeItem(AUTH_TOKEN_KEY);\n  localStorage.removeItem(\"Usuario\");\n  clearAdmin();\n}\n\n//COGER EL TOKEN\nexport function getAuthToken() {\n  return localStorage.getItem(AUTH_TOKEN_KEY);\n}\n\n//CONSIGUIENDO FECHA DE CADUCIDAD DEL TOKEN\nexport function getTokenExpirationDate(encodedToken) {\n  let token = jwt(encodedToken);\n  //si no hay, no sigue\n  if (!token.exp) {\n    return null;\n  }\n  let date = new Date(0);\n  date.setUTCSeconds(token.exp);\n  return date;\n}\n\n//COMPROBANDO SI LA FECHA SIGUE VIGENTE O NO\nexport function isTokenExpired(token) {\n  let expirationDate = getTokenExpirationDate(token);\n  return expirationDate < new Date();\n}\n\n//COMPROBAR SI EL USER ESTÁ LOGEADO O NO\nexport function isLoggedIn() {\n  let authToken = getAuthToken();\n  return !!authToken && !isTokenExpired(authToken);\n}\n\n//  ----FUNCIONES PARA COMPROBAR EL ROL DEL USER-----\n\n//GUARDAR SI ES ADMIN EN LOCAL STORAGE\nexport function setIsAdmin(isAdmin) {\n  localStorage.setItem(ROLE, isAdmin);\n}\n\n//BORRAR ROL DEL USER EN LOCAL STORAGE\nexport function clearAdmin() {\n  return localStorage.removeItem(ROLE);\n}\n\n// RECUPERAR ROL DESDE LOCAL STORAGE\nexport function getIsAdmin() {\n  return localStorage.getItem(ROLE);\n}\n\n//COMPROBAR ROL\nexport function checkAdmin() {\n  let role = false;\n  let isAdmin = getIsAdmin();\n  if (isAdmin === \"true\") {\n    role = true;\n  } else {\n    role = false;\n  }\n  return role;\n}\n"]}]}